<div align="center">
<p><img alt="Savlo" width="132" style="max-width:40%;min-width:60px;" src="https://salvo.rs/images/logo-text.svg" /></p>
<p>
    <a href="https://github.com/salvo-rs/salvo/blob/main/README.md">English</a>&nbsp;&nbsp;
    <a href="https://github.com/salvo-rs/salvo/blob/main/README.zh-hans.md">简体中文</a>&nbsp;&nbsp;
    <a href="https://github.com/salvo-rs/salvo/blob/main/README.zh-hant.md">繁體中文</a>
</p>
<p>
<a href="https://github.com/salvo-rs/salvo/actions">
    <img alt="build status" src="https://github.com/salvo-rs/salvo/workflows/ci-linux/badge.svg?branch=main&event=push" />
</a>
<a href="https://github.com/salvo-rs/salvo/actions">
    <img alt="build status" src="https://github.com/salvo-rs/salvo/workflows/ci-macos/badge.svg?branch=main&event=push" />
</a>
<a href="https://github.com/salvo-rs/salvo/actions">
    <img alt="build status" src="https://github.com/salvo-rs/salvo/workflows/ci-windows/badge.svg?branch=main&event=push" />
</a>
<br>
<a href="https://discord.gg/rUHf3spK">
    <img src="https://img.shields.io/discord/1041442427006890014.svg?logo=discord">
</a>
<a href="https://crates.io/crates/salvo"><img alt="crates.io" src="https://img.shields.io/crates/v/salvo" /></a>
<a href="https://docs.rs/salvo"><img alt="Documentation" src="https://docs.rs/salvo/badge.svg" /></a>
<a href="https://github.com/rust-secure-code/safety-dance/"><img alt="unsafe forbidden" src="https://img.shields.io/badge/unsafe-forbidden-success.svg" /></a>
<a href="https://blog.rust-lang.org/2022/09/22/Rust-1.64.0.html"><img alt="Rust Version" src="https://img.shields.io/badge/rust-1.64%2B-blue" /></a>
<br>
<a href="https://salvo.rs">
    <img alt="Website" src="https://img.shields.io/badge/https-salvo.rs-%23f00" />
</a>
<a href="https://codecov.io/gh/salvo-rs/salvo"><img alt="codecov" src="https://codecov.io/gh/salvo-rs/salvo/branch/main/graph/badge.svg" /></a>
<a href="https://crates.io/crates/salvo"><img alt="Download" src="https://img.shields.io/crates/d/salvo.svg" /></a>
<img alt="License" src="https://img.shields.io/crates/l/salvo.svg" />
</p>
</div>

`salvo_oapi` allows you to easily implement Apis that comply with the `OpenApiv3` specification.
It uses procedural macros to generate a lots of boilerplate code, so that you only need to focus on the more 
important business implementations.

* [Docs](https://docs.rs/salvo_oapi)
* [Cargo package](https://crates.io/crates/salvo_oapi)

## Features

* **Type safety** If your codes can be compiled, then it is fully compliant with the `OpenApi v3` specification.
* **Rustfmt friendly** Do not create any DSL that does not conform to Rust's syntax specifications.
* **IDE friendly** Any code generated by the procedural macro will not be used directly.
* **Minimal overhead** All generated code is necessary, and there is almost no overhead.

## Crate features

To avoid compiling unused dependencies, salvo_oapi gates certain features, some of which are disabled by default:

| Feature      | Description                                                                      |
|--------------|----------------------------------------------------------------------------------|
| chrono       | Integrate with the [`chrono` crate](https://crates.io/crates/chrono).            |
| swagger-ui   | Add swagger UI support                                                           |
| email        | Support for email address string                                                 |
| hostname     | Support for hostname string                                                      |
| uuid         | Integrate with the [`uuid` crate](https://crates.io/crates/uuid)                 |
| url          | Integrate with the [`url` crate](https://crates.io/crates/url)                   |
| bson         | Integrate with the [`bson` crate](https://crates.io/crates/bson)                 |
| rust_decimal | Integrate with the [`rust_decimal` crate](https://crates.io/crates/rust_decimal) |
| static-files | Support for static file response                                                 |

## Safety

This crate uses `#![forbid(unsafe_code)]` to ensure everything is implemented in 100% Safe Rust.

## Example

```rust
use salvo_core::prelude::*;
use salvo_oapi::extract::QueryParam;

#[endpoint]
async fn hello(body: QueryParamOption<String>>, res: &mut Response) {
    res.render(format!("{:?}", body))
}

#[tokio::main]
async fn main() -> Result<(), std::io::Error> {
    let router = Router::new()
        .push(Router::with_path("hello").get(hello))

    let doc = OpenApi::new("Hello API", "0.0.1").merge_router(&router);

    let router = router
        .unshift(doc.into_router("/api-doc/openapi.json"))
        .unshift(SwaggerUi::new("/api-doc/openapi.json").into_router("swagger-ui"));

    let acceptor = TcpListener::new("127.0.0.1:5800").bind().await;
    Server::new(acceptor).serve(router).await;
}
```

This feature needs to be opted-in. It can be done by adding the feature in `Cargo.toml` file
```toml filename=Cargo.toml
[dependencies]
salvo = { version = "0.39", features = ["oapi"]}
tokio = { version = "1", features = ["full"] }
```

## Run example

Open `http://localhost:5800/` in your browser, you will see the `Swagger UI` that contains these Api definitions.

```shell
> cargo run --example hello_world

> curl http://localhost:5800
hello!

> curl http://localhost:5800\?name\=chris
hello, chris!        
```


## Contributing

:balloon: Thanks for your help improving the project! We are so happy to have you!


## License

Licensed under either of

* Apache License, Version 2.0,([LICENSE-APACHE](./LICENSE-APACHE) or http://www.apache.org/licenses/LICENSE-2.0)
* MIT license ([LICENSE-MIT](./LICENSE-MIT) or http://opensource.org/licenses/MIT)
  at your option.

### Contribution

Unless you explicitly state otherwise, any contribution intentionally submitted for inclusion in salvo_oapi by you, shall be licensed as Apache, without any additional terms or conditions.
